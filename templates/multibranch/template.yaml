type: pipeline-template
version: 1
name: test
description: test
templateType: MULTIBRANCH
parameters:
  - name: organisation
    displayName: GitHub Organisation
    type: string
  - name: repoName
    displayName: Git Repository
    type: string
  - name: githubAppKey
    displayName: GitHub App Key (compatible with GitHub Checks) OR GitHub Auth Token
    type: CREDENTIALS
  - name: SourceToBuild
    displayName: Source to build (Accept Regex) - Example - ^(main|PR-.*|v1.*)
    type: string
    defaultValue: .*

multibranch:
  markerFile: ci-config.yaml
  branchSource:
    github:
      apiUri: test
      repoOwner: ${organisation}
      repository: ${repoName}
      credentialsId: ${githubAppKey}
    buildStrategies:
      - skipInitialBuildOnFirstIndexingResetRevision: {
        }
    strategy:
      allBranchesSame:
        props:
        - suppressAutomaticTriggering:
            triggeredBranchesRegex: ${SourceToBuild}
            strategy: INDEXING
